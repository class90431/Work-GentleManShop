{"remainingRequest":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/babel-loader/lib/index.js!/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/heather/Desktop/Harden/work-ecshop/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/heather/Desktop/Harden/work-ecshop/src/views/Cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/heather/Desktop/Harden/work-ecshop/src/views/Cart.vue","mtime":1560927529000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/heather/Desktop/Harden/work-ecshop/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import Pagination from '../components/Pagination'\n// import $ from 'jquery'\nimport { mapGetters, mapActions } from 'vuex';\nexport default {\n  data: function data() {\n    return {\n      coupon_code: '',\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: ''\n        },\n        message: ''\n      }\n    };\n  },\n  methods: _objectSpread({\n    removeCartItem: function removeCartItem(id) {\n      // console.log(item.id)\n      // const vm = this\n      // vm.isLoading = true\n      // const api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/cart/${item.id}`\n      // this.$http.delete(api).then((response) => {\n      //   console.log(response.data)\n      //   vm.isLoading = false\n      //   vm.$bus.$emit('messsage:push', response.data.message, 'info') // 刪除購物車品項\n      //   vm.getCart()\n      // })\n      this.$store.dispatch('removeCartItem', {\n        id: id,\n        vm: this\n      });\n    },\n    addCouponCode: function addCouponCode() {\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/coupon\");\n      var vm = this;\n      var Coupon = {\n        code: vm.coupon_code\n      };\n      this.$http.post(api, {\n        data: Coupon\n      }).then(function (response) {\n        console.log(response.data);\n\n        if (response.data.success) {\n          vm.$bus.$emit('messsage:push', '成功套用優惠碼!', 'success'); // 套用優惠碼’成功‘\n\n          vm.coupon_code = '';\n          vm.getCart();\n        } else {\n          vm.$bus.$emit('messsage:push', response.data.message, 'danger'); // 套用優惠碼’失敗‘\n        }\n      });\n    },\n    createOrder: function createOrder() {\n      var _this = this;\n\n      var vm = this;\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/order\");\n      var order = vm.form;\n      this.$validator.validate().then(function (valid) {\n        if (valid) {\n          console.log('訂單完成');\n\n          _this.$http.post(api, {\n            data: order\n          }).then(function (response) {\n            console.log(response);\n\n            if (response.data.success) {\n              vm.$router.push(\"/product/checkout/\".concat(response.data.orderId));\n            }\n          });\n        } else {\n          // console.log('欄位不完整')\n          vm.$bus.$emit('messsage:push', '欄位不完整', 'danger');\n        }\n      });\n    }\n  }, mapActions(['getCart'])),\n  computed: _objectSpread({}, mapGetters(['isLoading', 'cart'])),\n  created: function created() {\n    this.getCart(); // console.log(this.cart)\n    // console.log(typeof (this.cart.total))\n    // console.log(typeof (this.cart.final_total))\n  }\n};",{"version":3,"sources":["Cart.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"cart\">\n    <loading :active.sync=\"isLoading\"></loading>\n      <div class=\"main container\">\n        <div v-if=\"cart.total === 0\">\n          <p class=\"h2 my-5\">購物車尚無商品哦！</p>\n          <!-- <button class=\"btn btn-outline-dark\">Back to shop</button> -->\n          <router-link :to=\"{name: 'new'}\" class=\"btn btn-outline-dark\">Back to shop</router-link>\n        </div>\n        <!-- 購物車表格 -->\n        <div v-else class=\"row justify-content-center\">\n          <table class=\"table table-striped col-8\">\n            <thead>\n              <tr>\n                <th width=\"80\" scope=\"col\">#</th>\n                <th scope=\"col\">品名</th>\n                <th width=\"100\" scope=\"col\">尺寸</th>\n                <th width=\"100\" scope=\"col\">數量</th>\n                <th width=\"120\" scope=\"col\">單價</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(item, index) in cart.carts\" :key=\"index\">\n                <td>\n                  <button type=\"button\" class=\"btn btn-outline-danger btn-sm\" @click=\"removeCartItem(item.id)\">\n                    <i class=\"far fa-trash-alt\" ></i>\n                  </button>\n                </td>\n                <td>{{ item.product.title }}</td>\n                <td>{{ item.size }}</td>\n                <td>{{ item.qty }} / {{ item.product.unit }}</td>\n                <td class=\"text-right\">{{ item.total }}</td>\n              </tr>\n              <tr class=\"bg-info text-white text-right\">\n                <td></td>\n                <td></td>\n                <td></td>\n                <td v-if=\"cart.total == cart.final_total\">總價</td>\n                <td v-else><del class=\"text-white\">總價</del></td>\n                <td v-if=\"cart.total == cart.final_total\" class=\"text-right\">{{ cart.total }}</td>\n                <td v-else class=\"text-right\"><del class=\"text-white\">{{ cart.total }}</del></td>\n              </tr>\n              <tr class=\"text-right\" v-if=\"cart.total !== cart.final_total\">\n                <td></td>\n                <td></td>\n                <td></td>\n                <td class=\"text-success\"><strong>折扣價</strong></td>\n                <td class=\"text-success text-right\"><strong>{{ cart.final_total | integer }}</strong></td>\n              </tr>\n            </tbody>\n          </table>\n            <!-- 優惠碼 Input -->\n          <div class=\"input-group mb-3 col-8\">\n            <input v-model=\"coupon_code\" type=\"text\" class=\"form-control\" placeholder=\"請輸入優惠代碼\">\n            <div class=\"input-group-append\">\n              <button class=\"btn btn-outline-secondary\" type=\"button\" @click.prevent=\"addCouponCode\">套用優惠代碼</button>\n            </div>\n          </div>\n        </div>\n        <div v-if=\"cart.total !== 0\" class=\"row d-flex justify-content-center\">\n          <!-- 收件人資料 Form -->\n          <form class=\"mt-5 col-6\" @submit.prevent=\"createOrder\">\n            <div class=\"form-group\">\n              <label for=\"useremail\" class=\"h5 d-flex justify-content-start\">Email</label>\n              <input type=\"text\" v-validate=\"'required|email'\"  v-model=\"form.user.email\"\n                name=\"email\" id=\"useremail\" class=\"form-control\"  placeholder=\"請輸入 Email\">\n              <span class=\"text-danger\" v-if=\"errors.has('email')\">{{ errors.first('email') }}</span>\n            </div>\n            <div class=\"form-group\">\n              <label for=\"username\" class=\"h5 d-flex justify-content-start\">收件人姓名</label>\n              <input type=\"text\" v-validate=\"'required'\" :class=\"{'is-invalid': errors.has('name')}\" v-model=\"form.user.name\"\n                name=\"name\" id=\"username\" class=\"form-control\" placeholder=\"請輸入姓名\">\n              <span class=\"text-danger\" v-if=\"errors.has('name')\">請輸入姓名</span>\n            </div>\n            <div class=\"form-group\">\n              <label for=\"userphone\" class=\"h5 d-flex justify-content-start\">收件人電話</label>\n              <input type=\"text\" v-validate=\"'required'\" :class=\"{'is-invalid': errors.has('phone')}\" v-model=\"form.user.tel\"\n                name=\"phone\" id=\"userphone\" class=\"form-control\" placeholder=\"請輸入電話\">\n              <span class=\"text-danger\" v-if=\"errors.has('phone')\">請輸入電話</span>\n            </div>\n            <div class=\"form-group\">\n              <label for=\"useradress\" class=\"h5 d-flex justify-content-start\">收件人地址</label>\n              <input type=\"text\"  v-validate=\"'required'\" :class=\"{'is-invalid': errors.has('address')}\" v-model=\"form.user.address\"\n                name=\"address\" id=\"useradress\" class=\"form-control\" placeholder=\"請輸入地址\">\n              <span class=\"text-danger\" v-if=\"errors.has('address')\">請輸入地址</span>\n            </div>\n            <div class=\"form-group\">\n              <label for=\"usermessage\" class=\"h5 d-flex justify-content-start\">留言</label>\n              <textarea class=\"form-control\" name=\"\" id=\"usermessage\" rows=\"3\" v-model=\"form.message\"></textarea>\n            </div>\n            <div class=\"text-right\">\n              <button type=\"submit\" class=\"btn btn-danger mb-2\" >送出</button>\n            </div>\n          </form>\n        </div>\n        <!-- Pagination -->\n        <!-- <Pagination v-if=\"carts.total !== 0\" :paginationComponent=\"pagination\" v-on:turnpage=\"getProducts\"></Pagination> -->\n      </div>\n  </div>\n</template>\n\n<script>\n// import Pagination from '../components/Pagination'\n// import $ from 'jquery'\nimport { mapGetters, mapActions } from 'vuex'\nexport default {\n  data () {\n    return {\n      coupon_code: '',\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: ''\n        },\n        message: ''\n      }\n    }\n  },\n  methods: {\n    removeCartItem (id) {\n      // console.log(item.id)\n      // const vm = this\n      // vm.isLoading = true\n      // const api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/cart/${item.id}`\n      // this.$http.delete(api).then((response) => {\n      //   console.log(response.data)\n      //   vm.isLoading = false\n      //   vm.$bus.$emit('messsage:push', response.data.message, 'info') // 刪除購物車品項\n      //   vm.getCart()\n      // })\n      this.$store.dispatch('removeCartItem', { id, vm: this })\n    },\n    addCouponCode () {\n      const api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/coupon`\n      const vm = this\n      const Coupon = {\n        code: vm.coupon_code\n      }\n      this.$http.post(api, { data: Coupon }).then((response) => {\n        console.log(response.data)\n        if (response.data.success) {\n          vm.$bus.$emit('messsage:push', '成功套用優惠碼!', 'success') // 套用優惠碼’成功‘\n          vm.coupon_code = ''\n          vm.getCart()\n        } else {\n          vm.$bus.$emit('messsage:push', response.data.message, 'danger') // 套用優惠碼’失敗‘\n        }\n      })\n    },\n    createOrder () {\n      const vm = this\n      const api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/order`\n      const order = vm.form\n      this.$validator.validate().then((valid) => {\n        if (valid) {\n          console.log('訂單完成')\n          this.$http.post(api, { data: order }).then((response) => {\n            console.log(response)\n            if (response.data.success) {\n              vm.$router.push(`/product/checkout/${response.data.orderId}`)\n            }\n          })\n        } else {\n          // console.log('欄位不完整')\n          vm.$bus.$emit('messsage:push', '欄位不完整', 'danger')\n        }\n      })\n    },\n    ...mapActions(['getCart'])\n  },\n  computed: {\n    ...mapGetters(['isLoading', 'cart'])\n  },\n  created () {\n    this.getCart()\n    // console.log(this.cart)\n    // console.log(typeof (this.cart.total))\n    // console.log(typeof (this.cart.final_total))\n  }\n}\n\n</script>\n<style lang=\"scss\" scoped>\n</style>\n"],"sourceRoot":"src/views"}]}