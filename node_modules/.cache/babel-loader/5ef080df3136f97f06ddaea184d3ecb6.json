{"remainingRequest":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/thread-loader/dist/cjs.js!/Users/heather/Desktop/Harden/work-ecshop/node_modules/babel-loader/lib/index.js!/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/heather/Desktop/Harden/work-ecshop/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/heather/Desktop/Harden/work-ecshop/src/views/Coupons.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/heather/Desktop/Harden/work-ecshop/src/views/Coupons.vue","mtime":1561023110000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// 帳號： ud11336699@gmail.com\n// 密碼： 11336699\nimport $ from 'jquery';\nexport default {\n  data: function data() {\n    return {\n      isLoading: false,\n      coupons: [],\n      tempCoupon: {\n        title: '',\n        percent: 100,\n        is_enabled: 0,\n        due_date: 0,\n        code: ''\n      },\n      due_date: new Date(),\n      isNew: false,\n      tempApi: '',\n      isDelete: false\n    };\n  },\n  watch: {\n    due_date: function due_date() {\n      var vm = this;\n      var timestamp = Math.floor(new Date(vm.due_date) / 1000);\n      vm.tempCoupon.due_date = timestamp;\n    }\n  },\n  methods: {\n    getCoupons: function getCoupons() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/coupons?page=\").concat(page);\n      var vm = this;\n      vm.isLoading = true;\n      this.$http.get(api).then(function (response) {\n        console.log(response.data);\n        vm.isLoading = false;\n        vm.coupons = response.data.coupons;\n        console.log(vm.coupons);\n      });\n    },\n    openModal: function openModal(isNew, item) {\n      if (isNew) {\n        this.tempCoupon = {};\n        this.isNew = true;\n      } else {\n        this.tempCoupon = Object.assign({}, item);\n        this.isNew = false;\n      }\n\n      $('#couponModal').modal('show');\n    },\n    updateCoupon: function updateCoupon() {\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/coupon\");\n      var httpMethod = 'post';\n      var vm = this;\n\n      if (!vm.isNew) {\n        api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/coupon/\").concat(vm.tempCoupon.id);\n        httpMethod = 'put';\n      }\n\n      this.$http[httpMethod](api, {\n        data: vm.tempCoupon\n      }).then(function (response) {\n        console.log(response.data);\n\n        if (response.data.success) {\n          $('#couponModal').modal('hide');\n          vm.$bus.$emit('messsage:push', response.data.message, 'success'); // Alert: 已建立新產品\n\n          vm.getCoupons();\n        } else {\n          console.log('新增失敗');\n        } // vm.products = response.data.products;\n\n      });\n    },\n    deleteModal: function deleteModal(item) {\n      this.tempCoupon = item;\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/coupon/\").concat(item.id);\n      this.tempApi = api;\n      this.isDelete = false;\n      $('#delCouponModal').modal('show');\n    },\n    deleteCoupon: function deleteCoupon() {\n      var _this = this;\n\n      var vm = this;\n      this.isDelete = true;\n\n      if (this.isDelete) {\n        this.$http.delete(vm.tempApi).then(function (response) {\n          console.log(response.data);\n          $('#delCouponModal').modal('hide');\n\n          _this.$bus.$emit('messsage:push', response.data.message, 'danger'); // Alert: 已刪除優惠券\n\n\n          vm.getCoupons();\n        });\n      }\n    }\n  },\n  created: function created() {\n    this.getCoupons();\n  }\n};",{"version":3,"sources":["Coupons.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <loading :active.sync=\"isLoading\"></loading>\n    <div class=\"text-right mt-4\">\n      <button class=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#exampleModal\"\n        @click=\"openModal(true)\">建立新的優惠券\n      </button>\n    </div>\n    <table class=\"table mt-4\">\n      <thead>\n        <tr>\n          <th class=\"text-left\">名稱</th>\n          <th width=\"120\">折扣百分比</th>\n          <th width=\"200\">到期日</th>\n          <th width=\"100\">是否啟用</th>\n          <th width=\"150\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"(item, index) in coupons\" :key=\"index\">\n          <td class=\"text-left\">{{ item.title }}</td>\n          <td>{{ item.percent }}%</td>\n          <td>\n            {{ item.due_date | time }}\n          </td>\n          <td>\n            <span v-if=\"item.is_enabled\" class=\"text-success\">啟用</span>\n            <span v-else class=\"text-danger\">未啟用</span>\n          </td>\n          <td>\n            <button type=\"button\" class=\"btn-sm btn btn-outline-primary\" @click.prevent=\"openModal(false,item)\">編輯</button>\n            <button type=\"button\" class=\"btn-sm btn btn-outline-danger\" @click.prevent=\"deleteModal(item)\">刪除</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <!-- Modal -->\n    <div class=\"modal fade\" id=\"couponModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\"\n      aria-hidden=\"true\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">新增優惠券</h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            <div class=\"form-group \">\n              <label class=\"text-left\" for=\"title\">名稱</label>\n              <input type=\"text\" class=\"form-control\" id=\"title\" v-model=\"tempCoupon.title\"\n                placeholder=\"請輸入名稱\">\n            </div>\n            <div class=\"form-group\">\n              <label for=\"coupon_code\">優惠碼</label>\n              <input type=\"text\" class=\"form-control\" id=\"coupon_code\" v-model=\"tempCoupon.code\"\n                placeholder=\"請輸入優惠碼\">\n            </div>\n            <div class=\"form-group \">\n              <label for=\"percent\">折扣百分比</label>\n              <input type=\"number\" class=\"form-control\" id=\"percent\" v-model=\"tempCoupon.percent\"\n                placeholder=\"請輸入百分比\">\n            </div>\n            <div class=\"form-group \">\n              <label for=\"due_date\">到期日 </label>\n              <input type=\"date\" class=\"form-control\" id=\"due_date\"\n                v-model=\"due_date\">\n            </div>\n            <div class=\"form-group\">\n              <div class=\"form-check\">\n                <input class=\"form-check-input\" type=\"checkbox\" id=\"is_enabled\"\n                  v-model=\"tempCoupon.is_enabled\" :true-value=\"1\" :false-value=\"0\">\n                <label class=\"form-check-label\" for=\"is_enabled\">\n                  是否啟用\n                </label>\n              </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"updateCoupon\">確認</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- 刪除 Modal -->\n    <div class=\"modal fade\" id=\"delCouponModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\"\n      aria-hidden=\"true\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-danger text-white\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n              <span>刪除優惠券</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            是否刪除 <strong class=\"text-danger\">{{ tempCoupon.title }}</strong> 優惠券(刪除後將無法恢復)。\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-danger\" @click.prevent=\"deleteCoupon\">確認刪除</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// 帳號： ud11336699@gmail.com\n// 密碼： 11336699\nimport $ from 'jquery'\nexport default {\n  data () {\n    return {\n      isLoading: false,\n      coupons: [],\n      tempCoupon: {\n        title: '',\n        percent: 100,\n        is_enabled: 0,\n        due_date: 0,\n        code: ''\n      },\n      due_date: new Date(),\n      isNew: false,\n      tempApi: '',\n      isDelete: false\n    }\n  },\n  watch: {\n    due_date () {\n      const vm = this\n      const timestamp = Math.floor(new Date(vm.due_date) / 1000)\n      vm.tempCoupon.due_date = timestamp\n    }\n  },\n  methods: {\n    getCoupons (page = 1) {\n      let api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/coupons?page=${page}`\n      const vm = this\n      vm.isLoading = true\n      this.$http.get(api).then((response) => {\n        console.log(response.data)\n        vm.isLoading = false\n        vm.coupons = response.data.coupons\n        console.log(vm.coupons)\n      })\n    },\n    openModal (isNew, item) {\n      if (isNew) {\n        this.tempCoupon = {}\n        this.isNew = true\n      } else {\n        this.tempCoupon = Object.assign({}, item)\n        this.isNew = false\n      }\n      $('#couponModal').modal('show')\n    },\n    updateCoupon () {\n      let api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/coupon`\n      let httpMethod = 'post'\n      const vm = this\n      if (!vm.isNew) {\n        api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/coupon/${vm.tempCoupon.id}`\n        httpMethod = 'put'\n      }\n      this.$http[httpMethod](api, { data: vm.tempCoupon }).then((response) => {\n        console.log(response.data)\n        if (response.data.success) {\n          $('#couponModal').modal('hide')\n          vm.$bus.$emit('messsage:push', response.data.message, 'success') // Alert: 已建立新產品\n          vm.getCoupons()\n        } else {\n          console.log('新增失敗')\n        }\n        // vm.products = response.data.products;\n      })\n    },\n    deleteModal (item) {\n      this.tempCoupon = item\n      let api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/coupon/${item.id}`\n      this.tempApi = api\n      this.isDelete = false\n      $('#delCouponModal').modal('show')\n    },\n    deleteCoupon () {\n      const vm = this\n      this.isDelete = true\n      if (this.isDelete) {\n        this.$http.delete(vm.tempApi).then((response) => {\n          console.log(response.data)\n          $('#delCouponModal').modal('hide')\n          this.$bus.$emit('messsage:push', response.data.message, 'danger') // Alert: 已刪除優惠券\n          vm.getCoupons()\n        })\n      }\n    }\n  },\n  created () {\n    this.getCoupons()\n  }\n}\n</script>\n"],"sourceRoot":"src/views"}]}