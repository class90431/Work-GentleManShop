{"remainingRequest":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/babel-loader/lib/index.js!/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/heather/Desktop/Harden/work-ecshop/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/heather/Desktop/Harden/work-ecshop/src/views/ProductList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/heather/Desktop/Harden/work-ecshop/src/views/ProductList.vue","mtime":1561022794000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/heather/Desktop/Harden/work-ecshop/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\nimport _typeof from \"/Users/heather/Desktop/Harden/work-ecshop/node_modules/@babel/runtime-corejs2/helpers/esm/typeof\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// 帳號： ud11336699@gmail.com\n// 密碼： 11336699\nimport $ from 'jquery'; // 載入 jQuery\n\nimport Pagination from \"../components/Pagination\";\nexport default {\n  data: function data() {\n    return {\n      allProducts: [],\n      products: [],\n      tempProduct: {},\n      pagination: {},\n      isNew: false,\n      isDelete: false,\n      isLoading: false,\n      status: {\n        uploadFile: false,\n        isReverse: false,\n        isPagination: false // Pagination 元件顯示開關\n\n      },\n      disabled: 0,\n      sortItem: ''\n    };\n  },\n  methods: {\n    getAllProducts: function getAllProducts() {\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/products/all\");\n      var vm = this;\n      this.$http.get(api).then(function (response) {\n        console.log(api);\n        console.log(response.data);\n        vm.allProducts = response.data.products;\n        console.log(vm.allProducts);\n      });\n    },\n    getProducts: function getProducts() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/products?page=\").concat(page);\n      var vm = this;\n      vm.isLoading = true;\n      this.$http.get(api).then(function (response) {\n        console.log(api);\n        console.log(response.data);\n        vm.products = response.data.products;\n        vm.isLoading = false;\n        console.log(vm.products);\n        vm.pagination = response.data.pagination;\n        console.log(vm.pagination);\n      });\n    },\n    openModal: function openModal(isNew, isDelete, item) {\n      if (!isDelete) {\n        // 判斷開啟哪個 Modal(編輯 or 刪除), !isDelete 是編輯。\n        if (isNew) {\n          // 判斷是否為新的產品。如果 isNew = true 代表是新產品; 如果 isNew = false 代表是要編輯產品\n          this.tempProduct = {};\n          this.isNew = true;\n          this.disabled = false; // 預設 checkbox 不打鉤\n        } else {\n          //  this.tempProduct = item 物件傳參考的特性，如果這樣寫則 item 會複寫 tempProduct\n          this.tempProduct = Object.assign({}, item); // Object.assign 是 ES6 的方法：https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n\n          this.isNew = false;\n\n          if (this.tempProduct.price === this.tempProduct.origin_price) {\n            // 判斷‘原價’與’售價‘是否相等。如果相等，則 checkbox 預設為打鉤.\n            this.disabled = 1;\n          } else {\n            this.disabled = 0;\n          }\n        }\n\n        $('#productModal').modal('show'); // 打開 Modal\n      } else {\n        // isDelete = true\n        $('#delProductModal').modal('show');\n        this.tempProduct = Object.assign({}, item);\n        this.isDelete = true;\n      }\n    },\n    updateProduct: function updateProduct() {\n      // httpMethod = 'post', 'put', 'delete' 分別代表 '新增', '編輯', '刪除'\n      var api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/product\");\n      var httpMethod = 'post';\n      var vm = this; // console.log(vm.isNew, vm.isDelete)\n\n      if (!vm.isNew && !vm.isDelete) {\n        // 判斷是已有的產品 且 沒有要刪除，則更改 api 以及 ’方法(httpMethod)‘\n        api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/product/\").concat(vm.tempProduct.id);\n        httpMethod = 'put';\n      } else if (!vm.isNew && vm.isDelete) {\n        // 判斷是已有的產品 且 要刪除，則更改 api 以及 ’方法(httpMethod)‘\n        api = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/product/\").concat(vm.tempProduct.id);\n        httpMethod = 'delete';\n        vm.isDelete = false;\n      }\n\n      this.$http[httpMethod](api, {\n        data: vm.tempProduct\n      }).then(function (response) {\n        console.log(response.data);\n\n        if (response.data) {\n          $('#productModal').modal('hide');\n          $('#delProductModal').modal('hide');\n          vm.$bus.$emit('messsage:push', response.data.message, 'success');\n          vm.getProducts(vm.pagination.current_page); // ’編輯完成‘後 更新頁面至 ‘當前頁面’\n\n          vm.getAllProducts();\n        } else {\n          $('#productModal').modal('hide');\n          vm.$bus.$emit('messsage:push', response.data.message, 'danger');\n          console.log('失敗');\n        }\n      });\n    },\n    uploadFile: function uploadFile() {\n      var _this = this;\n\n      // 上傳照片\n      // console.log(this)\n      var uploadedFile = this.$refs.files.files[0]; // 此為照片檔案，可用 console.log(uploadedFile) 看\n      // console.log(uploadedFile)\n\n      var vm = this;\n      vm.status.uploadFile = true;\n      var formData = new FormData(); // 參考：https://developer.mozilla.org/zh-TW/docs/Web/API/FormData\n\n      formData.append('file-to-upload', uploadedFile);\n      var url = \"\".concat(process.env.VUE_APP_API_PATH, \"/api/\").concat(process.env.VUE_APP_CUSTOMER_PATH, \"/admin/upload\");\n      this.$http.post(url, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(function (response) {\n        console.log(response.data);\n\n        if (response.data.success) {\n          // vm.tempProduct.imageUrl = response.data.imageUrl\n          // console.log(vm.tempProduct.imageUrl)\n          // console.log(vm.tempProduct)\n          vm.$set(vm.tempProduct, 'imageUrl', response.data.imageUrl); // 因為無事先定義部分變數，所以用 $set 強制綁定\n\n          _this.$bus.$emit('messsage:push', '上傳成功', 'success');\n\n          vm.status.uploadFile = false;\n        } else {\n          console.log(response.data.message);\n\n          _this.$bus.$emit('messsage:push', response.data.message, 'warning');\n\n          vm.status.uploadFile = false;\n        }\n      });\n    },\n    checkboxTorF: function checkboxTorF() {\n      // 判斷 checkbox 是否有勾選\n      // console.log(this.disabled)\n      if (!this.disabled) {\n        // 如果有勾選：則原價 = 售價，且 input 是 disabled 的狀態\n        console.log(1);\n        this.tempProduct.price = this.tempProduct.origin_price;\n      } else {\n        this.tempProduct.price = '';\n        console.log(0);\n      }\n    },\n    sortSwitch: function sortSwitch(item) {\n      this.status.isPagination = true; // 將 Pagination 元件隱藏\n\n      this.sortItem = item;\n\n      if (this.sortItem === 'category' || this.sortItem === 'title') {\n        console.log(this.sortItem, this.status.isReverse);\n        this.status.isReverse = true;\n      } else if (this.sortItem === 'return') {\n        this.status.isPagination = false; // 將 Pagination 元件顯示\n      } else {\n        console.log(this.sortItem, _typeof(this.sortItem), this.status.isReverse);\n        this.status.isReverse = !this.status.isReverse; // 控制箭頭上下\n      }\n    }\n  },\n  computed: {\n    newData: function newData() {\n      var vm = this;\n\n      if (!this.status.isPagination) {\n        return this.products;\n      } else if (this.sortItem === 'category' || this.sortItem === 'title') {\n        var newData = vm.allProducts.sort(function (a, b) {\n          var A = a[vm.sortItem].toUpperCase(); // ignore upper and lowercase\n\n          var B = b[vm.sortItem].toUpperCase(); // ignore upper and lowercase\n\n          if (A < B) {\n            return -1;\n          }\n\n          if (A > B) {\n            return 1;\n          }\n\n          return 0;\n        });\n        return newData;\n      } else if (this.status.isReverse) {\n        var _newData = vm.allProducts.sort(function (a, b) {\n          return a[vm.sortItem] - b[vm.sortItem];\n        });\n\n        return _newData;\n      } else if (!this.status.isReverse) {\n        var _newData2 = vm.allProducts.sort(function (a, b) {\n          return b[vm.sortItem] - a[vm.sortItem];\n        });\n\n        return _newData2;\n      }\n    }\n  },\n  components: {\n    Pagination: Pagination\n  },\n  created: function created() {\n    this.getAllProducts();\n    this.getProducts();\n    console.log(this.disabled);\n  }\n};",{"version":3,"sources":["ProductList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <loading :active.sync=\"isLoading\"></loading>\n    <div class=\"text-right mt-4\">\n      <span>按表頭可以排序</span>\n      <button class=\"btn btn-dark mx-2\" @click.prevent=\"sortSwitch('return')\">還原為不排序</button>\n      <button class=\"btn btn-dark\" @click.prevent=\"openModal(true)\">Create a new product</button>\n    </div>\n    <table class=\"table mt-4\">\n      <thead>\n        <tr>\n          <th width=\"120\" class=\"hover-style\" @click=\"sortSwitch('category')\">分類\n            <span v-if=\"sortItem === 'category'\">\n              <i class=\" fas fa-angle-down text-info\" v-if=\"status.isReverse\"></i>\n            </span>\n          </th>\n          <th class=\"hover-style\" @click=\"sortSwitch('title')\">名稱\n            <span v-if=\"sortItem === 'title'\">\n              <i class=\" fas fa-angle-down text-info\" v-if=\"status.isReverse\"></i>\n            </span>\n          </th>\n          <th width=\"120\" class=\"hover-style\" @click=\"sortSwitch('origin_price')\">原價\n            <span v-if=\"sortItem === 'origin_price'\">\n              <i class=\" fas fa-angle-up text-info\" v-if=\"status.isReverse\"></i>\n              <i class=\" fas fa-angle-down text-info\" v-else></i>\n            </span>\n          </th>\n          <th width=\"120\" class=\"hover-style\" @click=\"sortSwitch('price')\">售價\n            <span v-if=\"sortItem === 'price'\">\n              <i class=\" fas fa-angle-up text-info\" v-if=\"status.isReverse\"></i>\n              <i class=\" fas fa-angle-down text-info\" v-else></i>\n            </span>\n          </th>\n          <th width=\"120\" class=\"hover-style\" @click=\"sortSwitch('is_enabled')\">是否啟用\n            <span v-if=\"sortItem === 'is_enabled'\">\n              <i class=\" fas fa-angle-up text-info\" v-if=\"status.isReverse\"></i>\n              <i class=\" fas fa-angle-down text-info\" v-else></i>\n            </span>\n          </th>\n          <th>編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"(item) in newData\" :key=\"item.id\">\n          <td>{{ item.category }}</td>\n          <td>{{ item.title }}</td>\n          <td class=\"text-right\">\n            {{ item.origin_price | currency }}\n          </td>\n          <td class=\"text-right\">\n            {{ item.price | currency }}\n          </td>\n          <td>\n            <span v-if=\"item.is_enabled\" class=\"text-success\">啟用</span>\n            <span v-else class=\"text-danger\">未啟用</span>\n          </td>\n          <td>\n            <button class=\"btn btn-outline-primary mr-1\"\n              @click.prevent=\"openModal(false, false, item)\">編輯</button>\n            <button class=\"btn btn-outline-danger\" @click.prevent=\"openModal(false, true, item)\">刪除</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <!-- Pagination -->\n    <Pagination :paginationComponent=\"pagination\" v-on:turnpage=\"getProducts\" v-if=\"!status.isPagination\"></Pagination>\n    <!-- Modal for create a new product-->\n        <div class=\"modal fade\" id=\"productModal\" tabindex=\"-1\" role=\"dialog\"\n      aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n      <div class=\"modal-dialog modal-lg\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-dark text-white\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n              <span>新增產品</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            <div class=\"row\">\n              <div class=\"col-sm-4\">\n                <div class=\"form-group\">\n                  <label for=\"image\">輸入圖片網址</label>\n                  <input type=\"text\" class=\"form-control\" id=\"image\"\n                    placeholder=\"請輸入圖片連結\" v-model=\"tempProduct.imageUrl\">\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"customFile\">或 上傳圖片\n                    <i class=\"fas fa-spinner fa-spin\" v-if=\"status.uploadFile == true\"></i>\n                  </label>\n                  <input type=\"file\" id=\"customFile\" class=\"form-control\"\n                    ref=\"files\" @change=\"uploadFile\">\n                </div>\n                <img class=\"img-fluid\" :src=\"tempProduct.imageUrl\" alt=\"\">\n              </div>\n              <div class=\"col-sm-8\">\n                <div class=\"form-group\">\n                  <label for=\"title\">標題</label>\n                  <input type=\"text\" class=\"form-control\" id=\"title\"\n                    placeholder=\"請輸入標題\" v-model=\"tempProduct.title\">\n                </div>\n\n                <div class=\"form-row\">\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"category\">分類</label>\n                    <!-- <input type=\"text\" class=\"form-control\" id=\"category\"\n                      placeholder=\"請輸入分類\" v-model=\"tempProduct.category\"> -->\n                      <select class=\"form-control\" v-model=\"tempProduct.category\">\n                        <option>最新商品</option>\n                        <option>熱賣商品</option>\n                        <option>人氣預購</option>\n                        <option>優惠折扣</option>\n                        <option>套裝</option>\n                        <option>上身</option>\n                        <option>下身</option>\n                        <option>鞋子</option>\n                        <option>配件</option>\n                      </select>\n                  </div>\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"price\">單位</label>\n                    <input type=\"unit\" class=\"form-control\" id=\"unit\"\n                      placeholder=\"請輸入單位\" v-model=\"tempProduct.unit\">\n                  </div>\n                </div>\n\n                <div class=\"form-row\">\n                  <div class=\"form-group col-md-6\">\n                  <label for=\"origin_price\">原價</label>\n                    <input type=\"number\" class=\"form-control mt-4\" id=\"origin_price\"\n                      placeholder=\"請輸入原價\" v-model=\"tempProduct.origin_price\">\n                  </div>\n                  <div class=\"form-group col-md-6\">\n                    <label for=\"price\">售價</label>\n                    <!-- <input type=\"number\" class=\"form-control\" id=\"price\"\n                      placeholder=\"請輸入售價\" v-model=\"tempProduct.price\"> -->\n                      <div class=\"form-check\">\n                        <input class=\"form-check-input\" type=\"checkbox\" id=\"defaultCheck1\"\n                          v-model=\"disabled\" @click=\"checkboxTorF\" :true-value=\"1\" :false-value=\"0\">\n                        <label class=\"form-check-label\" for=\"defaultCheck1\" style=\"font-size:.5rem\">\n                          與原價相同\n                        </label>\n                        <input type=\"number\" class=\"form-control\" id=\"price\" :disabled=\"disabled === 1\"\n                          placeholder=\"請輸入售價\" v-model=\"tempProduct.price\">\n                    </div>\n                  </div>\n                </div>\n                <hr>\n\n                <div class=\"form-group\">\n                  <label for=\"description\">產品描述</label>\n                  <textarea type=\"text\" class=\"form-control\" id=\"description\"\n                    placeholder=\"請輸入產品描述\" rows=\"5\" v-model=\"tempProduct.description\"></textarea>\n                </div>\n                <div class=\"form-group\">\n                  <label for=\"content\">說明內容</label>\n                  <textarea type=\"text\" class=\"form-control\" id=\"content\"\n                    placeholder=\"請輸入產品說明內容\" rows=\"5\" v-model=\"tempProduct.content\"></textarea>\n                </div>\n                <div class=\"form-group\">\n                  <div class=\"form-check\">\n                    <input class=\"form-check-input\" type=\"checkbox\"\n                      id=\"is_enabled\" v-model=\"tempProduct.is_enabled\" :true-value=\"1\" :false-value=\"0\">\n                    <label class=\"form-check-label\" for=\"is_enabled\">\n                      是否啟用\n                    </label>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-primary\" @click.prevent=\"updateProduct\">確認</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- Modal for makesure to delete the product-->\n    <div class=\"modal fade\" id=\"delProductModal\" tabindex=\"-1\" role=\"dialog\"\n      aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content border-0\">\n          <div class=\"modal-header bg-danger text-white\">\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n              <span>刪除產品</span>\n            </h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            是否刪除 <strong class=\"text-danger\">{{ tempProduct.title }}</strong> 商品(刪除後將無法恢復)。\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-dismiss=\"modal\">取消</button>\n            <button type=\"button\" class=\"btn btn-danger\" @click.prevent=\"updateProduct\">確認刪除</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// 帳號： ud11336699@gmail.com\n// 密碼： 11336699\nimport $ from 'jquery' // 載入 jQuery\nimport Pagination from '../components/Pagination'\nexport default {\n  data () {\n    return {\n      allProducts: [],\n      products: [],\n      tempProduct: {},\n      pagination: {},\n      isNew: false,\n      isDelete: false,\n      isLoading: false,\n      status: {\n        uploadFile: false,\n        isReverse: false,\n        isPagination: false // Pagination 元件顯示開關\n      },\n      disabled: 0,\n      sortItem: ''\n    }\n  },\n  methods: {\n    getAllProducts () {\n      const api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/products/all`\n      const vm = this\n      this.$http.get(api).then((response) => {\n        console.log(api)\n        console.log(response.data)\n        vm.allProducts = response.data.products\n        console.log(vm.allProducts)\n      })\n    },\n    getProducts (page = 1) {\n      const api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/products?page=${page}`\n      const vm = this\n      vm.isLoading = true\n      this.$http.get(api).then((response) => {\n        console.log(api)\n        console.log(response.data)\n        vm.products = response.data.products\n        vm.isLoading = false\n        console.log(vm.products)\n        vm.pagination = response.data.pagination\n        console.log(vm.pagination)\n      })\n    },\n    openModal (isNew, isDelete, item) {\n      if (!isDelete) { // 判斷開啟哪個 Modal(編輯 or 刪除), !isDelete 是編輯。\n        if (isNew) { // 判斷是否為新的產品。如果 isNew = true 代表是新產品; 如果 isNew = false 代表是要編輯產品\n          this.tempProduct = {}\n          this.isNew = true\n          this.disabled = false // 預設 checkbox 不打鉤\n        } else {\n          //  this.tempProduct = item 物件傳參考的特性，如果這樣寫則 item 會複寫 tempProduct\n          this.tempProduct = Object.assign({}, item) // Object.assign 是 ES6 的方法：https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n          this.isNew = false\n          if (this.tempProduct.price === this.tempProduct.origin_price) { // 判斷‘原價’與’售價‘是否相等。如果相等，則 checkbox 預設為打鉤.\n            this.disabled = 1\n          } else {\n            this.disabled = 0\n          }\n        }\n        $('#productModal').modal('show') // 打開 Modal\n      } else { // isDelete = true\n        $('#delProductModal').modal('show')\n        this.tempProduct = Object.assign({}, item)\n        this.isDelete = true\n      }\n    },\n    updateProduct () {\n      // httpMethod = 'post', 'put', 'delete' 分別代表 '新增', '編輯', '刪除'\n      let api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/product`\n      let httpMethod = 'post'\n      const vm = this\n      // console.log(vm.isNew, vm.isDelete)\n      if (!vm.isNew && !vm.isDelete) { // 判斷是已有的產品 且 沒有要刪除，則更改 api 以及 ’方法(httpMethod)‘\n        api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/product/${vm.tempProduct.id}`\n        httpMethod = 'put'\n      } else if (!vm.isNew && vm.isDelete) { // 判斷是已有的產品 且 要刪除，則更改 api 以及 ’方法(httpMethod)‘\n        api = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/product/${vm.tempProduct.id}`\n        httpMethod = 'delete'\n        vm.isDelete = false\n      }\n      this.$http[httpMethod](api, { data: vm.tempProduct }).then((response) => {\n        console.log(response.data)\n        if (response.data) {\n          $('#productModal').modal('hide')\n          $('#delProductModal').modal('hide')\n          vm.$bus.$emit('messsage:push', response.data.message, 'success')\n          vm.getProducts(vm.pagination.current_page) // ’編輯完成‘後 更新頁面至 ‘當前頁面’\n          vm.getAllProducts()\n        } else {\n          $('#productModal').modal('hide')\n          vm.$bus.$emit('messsage:push', response.data.message, 'danger')\n          console.log('失敗')\n        }\n      })\n    },\n    uploadFile () { // 上傳照片\n      // console.log(this)\n      const uploadedFile = this.$refs.files.files[0] // 此為照片檔案，可用 console.log(uploadedFile) 看\n      // console.log(uploadedFile)\n      const vm = this\n      vm.status.uploadFile = true\n      const formData = new FormData() // 參考：https://developer.mozilla.org/zh-TW/docs/Web/API/FormData\n      formData.append('file-to-upload', uploadedFile)\n      const url = `${process.env.VUE_APP_API_PATH}/api/${process.env.VUE_APP_CUSTOMER_PATH}/admin/upload`\n      this.$http.post(url, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then((response) => {\n        console.log(response.data)\n        if (response.data.success) {\n          // vm.tempProduct.imageUrl = response.data.imageUrl\n          // console.log(vm.tempProduct.imageUrl)\n          // console.log(vm.tempProduct)\n          vm.$set(vm.tempProduct, 'imageUrl', response.data.imageUrl) // 因為無事先定義部分變數，所以用 $set 強制綁定\n          this.$bus.$emit('messsage:push', '上傳成功', 'success')\n          vm.status.uploadFile = false\n        } else {\n          console.log(response.data.message)\n          this.$bus.$emit('messsage:push', response.data.message, 'warning')\n          vm.status.uploadFile = false\n        }\n      })\n    },\n    checkboxTorF () { // 判斷 checkbox 是否有勾選\n      // console.log(this.disabled)\n      if (!this.disabled) { // 如果有勾選：則原價 = 售價，且 input 是 disabled 的狀態\n        console.log(1)\n        this.tempProduct.price = this.tempProduct.origin_price\n      } else {\n        this.tempProduct.price = ''\n        console.log(0)\n      }\n    },\n    sortSwitch (item) {\n      this.status.isPagination = true // 將 Pagination 元件隱藏\n      this.sortItem = item\n      if (this.sortItem === 'category' || this.sortItem === 'title') {\n        console.log(this.sortItem, this.status.isReverse)\n        this.status.isReverse = true\n      } else if (this.sortItem === 'return') {\n        this.status.isPagination = false // 將 Pagination 元件顯示\n      } else {\n        console.log(this.sortItem, typeof (this.sortItem), this.status.isReverse)\n        this.status.isReverse = !this.status.isReverse // 控制箭頭上下\n      }\n    }\n  },\n  computed: {\n    newData () {\n      const vm = this\n      if (!this.status.isPagination) {\n        return this.products\n      } else if (this.sortItem === 'category' || this.sortItem === 'title') {\n        let newData = vm.allProducts.sort(function (a, b) {\n          var A = a[vm.sortItem].toUpperCase() // ignore upper and lowercase\n          var B = b[vm.sortItem].toUpperCase() // ignore upper and lowercase\n          if (A < B) {\n            return -1\n          }\n          if (A > B) {\n            return 1\n          }\n          return 0\n        })\n        return newData\n      } else if (this.status.isReverse) {\n        let newData = vm.allProducts.sort(function (a, b) {\n          return a[vm.sortItem] - b[vm.sortItem]\n        })\n        return newData\n      } else if (!this.status.isReverse) {\n        let newData = vm.allProducts.sort(function (a, b) {\n          return b[vm.sortItem] - a[vm.sortItem]\n        })\n        return newData\n      }\n    }\n  },\n  components: {\n    Pagination\n  },\n  created () {\n    this.getAllProducts()\n    this.getProducts()\n    console.log(this.disabled)\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .hover-style {\n    &:hover {\n      cursor: pointer;\n    }\n  }\n</style>\n"],"sourceRoot":"src/views"}]}